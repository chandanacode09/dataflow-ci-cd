# Terraform Configuration for bbc-news-pipeline-30 Triggers

This directory contains Terraform configuration to create Cloud Build triggers for the bbc-news-pipeline-30 pipeline.

## Prerequisites

### 1. Connect GitHub Repository (ONE-TIME SETUP)

**IMPORTANT**: You must connect your GitHub repository to Cloud Build before running Terraform.

**Option A: Using Google Cloud Console (Recommended)**

1. Go to: https://console.cloud.google.com/cloud-build/triggers/connect?project=axiomatic-robot-458302-r0
2. Click "Connect Repository"
3. Select "GitHub (Cloud Build GitHub App)"
4. Click "Authenticate with GitHub" and authorize
5. Select repository: `chandanacode09/dataflow-ci-cd`
6. Click "Connect"

**Option B: Check if already connected**

```bash
# List existing connections
gcloud builds connections list --region=us-central1

# If your repo is listed, you're good to go!
```

### 2. Install Terraform

```bash
# Install Terraform (>= 1.0)
# Download from: https://www.terraform.io/downloads
```

### 3. Authenticate to GCP

```bash
gcloud auth application-default login
```

## Creating Triggers

### Initialize Terraform

```bash
cd pipelines/bbc-news-pipeline-30/terraform
terraform init
```

### Review Changes

```bash
terraform plan
```

### Apply Configuration

```bash
terraform apply
```

This will create:
- **CI Trigger**: `bbc-news-pipeline-30-ci` - Runs on all branches
- **CD Trigger**: `bbc-news-pipeline-30-cd` - Deploys on main branch

## Modifying Triggers

1. Edit `main.tf` to modify trigger configuration
2. Run `terraform plan` to review changes
3. Run `terraform apply` to apply changes

## Destroying Triggers

To delete the triggers:

```bash
terraform destroy
```

## State Management

Terraform state is stored in GCS bucket:
- Bucket: `demo-terraform-state`
- Prefix: `dataflow-pipelines/bbc-news-pipeline-30`

## Auto-Generated

This configuration was auto-generated by the CI/CD Agent.
